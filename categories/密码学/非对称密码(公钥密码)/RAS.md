# RSA:

建立在大整数因式分解难题

## 1.RSA流程:

``` ras
生成密钥 → 加密 → 解密
```

## 2.生成密钥:

``` ras
1. 选择两个大质数 
   令：`p = 61, q = 53`

2. 计算模数 n 
   `n = p × q = 61 × 53 = 3233`    ---这个 n 是 公钥 和 私钥 中共同的模数。

3.计算欧拉函数 φ(n)
   `φ(n) = (p - 1)(q - 1) = 60 × 52 = 3120`

4. 选择加密指数 e  
   `e = 17`（满足 `gcd(17, 3120) = 1`）

5. 计算解密指数 d  
   `d = e⁻¹ mod φ(n) = 2753`（因为 `17 × 2753 ≡ 1 mod 3120`）

- ✅ 公钥：`(e, n) = (17, 3233)`
- 🔒 私钥：`(d, n) = (2753, 3233)`

```

## 3.加密流程:

首先，发送方需要知道接收方的**公钥 (e, n)**，其中：

- e 是加密指数，通常是一个公开的较小整数；
- n 是两个大质数相乘得到的模数；
- 公钥是公开的，任何人都可以用来加密消息。

接着，发送方将要发送的明文 M（需满足 0<M<n）使用以下公式进行加密：

  **C = M^e mod n**

## 4.解密流程:

接收方收到密文 C 之后，使用自己的私钥 (d,n) 对密文进行解密。私钥中的 d 是在密钥生成阶段计算出来的，是加密指数 e 关于欧拉函数 φ(n) 的模反元素，即满足 e⋅d ≡ 1 mod  φ(n)

解密公式为：

  **M = C^d mod n**

``` 交互
C = M^e mod n     ---加密得到C
C^d mod n  --> 
        ((M^e) mod n)^d mod n   -->  M^ed mod n       ---幂模分配律
ed=1  mod φ(n)   --> ed=k(φ(n))+1
M^(k(φ(n))+1) mod n --> M
```


# sm4加密:

## 1.概念:

``` sm4
SM4是一种分组密码算法，其分组长度为128位（即16字节，4字），密钥长度也为128位（即16字节，4字）。其加解密过程采用了32轮迭代机制（与DES、AES类似），每一轮需要一个轮密钥（与DES、AES类似）。
```

## 2.加密流程:

``` aes
输入：128 位明文 + 128 位密钥
↓
1. 明文拆成 4 个 32 位字：X0, X1, X2, X3
2. 密钥扩展：生成 32 个轮密钥 rk[0] ~ rk[31]
3. 执行 32 轮加密：
     对于每一轮 i = 0 到 31：
         X[i+4] = X[i] ⊕ F(X[i+1], X[i+2], X[i+3], rk[i])
4. 输出密文：X[35], X[34], X[33], X[32]（倒序输出）
```

## 3.F函数:

``` aes
F(X1, X2, X3, rk) = T(X1 ⊕ X2 ⊕ X3 ⊕ rk)
输入：X1, X2, X3, rk

Step 1:  temp = X1 ⊕ X2 ⊕ X3 ⊕ rk   → 32位
Step 2:  替代 temp 的每个字节 → 使用 S-box → 得到非线性结果
Step 3:  对结果进行线性变换 L(x)
Step 4:  输出最终的 F 值（32 位）
```

| 功能类型                | 说明                                         |
| ----------------------- | -------------------------------------------- |
| **混淆性**（Confusion） | 通过 S-box 实现非线性映射，防止线性分析      |
| **扩散性**（Diffusion） | L 线性变换使得一个比特变化影响多个比特       |
| **密钥注入**            | 引入轮密钥 rk[i]，确保每轮变换唯一           |
| **加密推进器**          | 每轮根据 F 生成新状态字，实现 128 位数据演化 |

# des加密:

## 1.基本概念:

``` des 
DES使用56位的密钥和64位的明文块进行加密。DES算法的分组大小是64位，因此，如果需要加密的明文长度不足64位，需要进行填充；如果明文长度超过64位，则需要使用分组模式进行分组加密。
虽然DES算法的分组大小是64位，但是由于DES算法的密钥长度只有56位，因此DES算法存在着弱点，容易受到暴力破解和差分攻击等攻击手段的威胁。因此，在实际应用中，DES算法已经不再被广泛使用，而被更加安全的算法所取代，如AES算法等。
```

## 2.加密流程：

![img](https://i-blog.csdnimg.cn/blog_migrate/13057fca8d2ae93a87bbceb559746832.png)

明文64位 → 初始置换（IP） → 16轮加密（Feistel结构） → 逆初始置换（IP⁻¹） → 密文64位

### F函数结构:
1. **扩展置换 E：**
   - 将 32位的R 扩展为 48位（E表）
      ⟹ 使其可以和 48位子密钥 `Ki` 做异或操作
2. **异或：**
   - 48位扩展后的R 与 48位子密钥 `Ki` 做异或
3. **S盒替换：**
   - 将 48位结果 分成 8组，每组6位
   - 进入 8个 S-box（6位 → 4位）进行非线性变换
   - 输出为 32位
4. **P置换：**
   - 对S盒输出的32位进行 P置换，增强扩散

最终得到 F(R, Ki) 的输出（32位）

## 3.三重des：

> **EDE 模式（Encrypt → Decrypt → Encrypt）**

```des
密文 = E_K3(D_K2(E_K1(明文)))
```

- **E_K1：** 用密钥K1进行DES加密
- **D_K2：** 用密钥K2进行DES解密
- **E_K3：** 再用密钥K3进行DES加密

中间使用一次解密是为了:
``` des
如果k1=k2=k3，那么这个3des就和普通的des一样了
```

